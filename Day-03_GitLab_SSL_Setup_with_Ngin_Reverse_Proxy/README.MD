# ğŸš€ GitLab SSL Setup with Nginx Reverse Proxy

## ğŸ” GitLab Access without SSL over HTTP

- **GitLab URL:** [http://gitlab.devopsinaction.lab/users/sign_in](http://gitlab.devopsinaction.lab/users/sign_in)
- **Username:** `root`
- **Password:** `usvYV8PGTGF5fiwe6`



## ğŸ§­ Overview

Weâ€™ll configure **SSL (HTTPS)** for GitLab using **Nginx as a reverse proxy**.
Hereâ€™s the workflow weâ€™ll achieve:

```
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   Client   â”‚
           â”‚ (Browser)  â”‚
           â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
          HTTPS :443 / :80
                 â”‚
                 â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚   Nginx Reverse Proxyâ”‚
       â”‚ (SSL termination)    â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚ HTTP :80
                â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   GitLab Serverâ”‚
        â”‚ (Dockerized)   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```



## ğŸ§° Step-by-Step Setup

### 1ï¸âƒ£ Stop Running Containers

```bash
docker compose down
```



### 2ï¸âƒ£ Check Existing Configuration

```bash
cd /HDD2TB/iansari/gitlab
grep -vE "^#|^$" ./gitlab/config/gitlab.rb
```



### 3ï¸âƒ£ Backup `gitlab.rb` Configuration

Make sure to back up before editing:

```bash
cp -a ./gitlab/config/gitlab.rb ./gitlab/config/gitlab_rb_original
```

Or move it instead:

```bash
mv ./gitlab/config/gitlab.rb ./gitlab/config/gitlab_rb_original
```



### 4ï¸âƒ£ Update `gitlab.rb` File

Open and edit the configuration:

```bash
sudo nano ./gitlab/config/gitlab.rb
```

Replace content or update these lines:

```ruby
nginx['enable'] = true
nginx['client_max_body_size'] = '250m'
nginx['listen_addresses'] = ['127.0.0.1']
nginx['listen_port'] = 80
nginx['listen_https'] = false
nginx['proxy_set_headers'] = {
  "X-Forwarded-Ssl" => "on",
}
```


### 5ï¸âƒ£ Runner SSL Setup

#### ğŸ”§ Update `compose.yaml`

Change `external_url` to use HTTPS:

```bash
nano compose.yaml
```

Update environment section:

```yaml
environment:
  - external_url=https://${GITLAB_HOST_URL}
```

Start container
```bash
docker compose up -d
```

âœ¨ **Now your GitLab instance runs securely behind an SSL-enabled Nginx reverse proxy!**


## ğŸ“¦ NPM Reverse Proxy Setup (with SSL + Force HTTPS)

Goal: Configure "gitlab.devopsinaction.lab" SSL and force use HTTPS.
- ğŸ‘‰ https://npm.devopsinaction.lab/nginx/proxy


## ğŸ” GitLab Access with SSL over HTTPS

- **GitLab URL:** [http://gitlab.devopsinaction.lab/users/sign_in](http://gitlab.devopsinaction.lab/users/sign_in)
- **Username:** `root`
- **Password:** `usvYV8PGTGF5fiwe6`


#### ğŸ”§ Update Runner Configuration

Edit runner config:

```bash
nano gitlab/runner/config.toml
```

Change GitLab URL:

```toml
url = "https://gitlab.devopsinaction.lab"
```


### Restart GitLab Runner

Apply the changes:

```bash
docker restart gitlab_runner
```


## âœ… Summary

| Step | Action          | Description                                   |
| ---- | --------------- | --------------------------------------------- |
| 1    | Stop containers | Prepare for config changes                    |
| 2    | Check config    | Review existing GitLab setup                  |
| 3    | Backup          | Protect original `gitlab.rb`                  |
| 4    | Edit config     | Set Nginx to HTTP (reverse proxy handles SSL) |
| 5    | Update runner   | Point to HTTPS GitLab URL                     |
| 6    | Restart runner  | Apply new configuration                       |



## ğŸ§  About This Project

This project is maintained by **DevOps In Action**, mainly focusing on practical, hands-on DevOps setups for CI/CD automation, containerization, and infrastructure management.

### ğŸ’¼ Connect with Me ğŸ‘‡ğŸ˜Š

* ğŸ”¥ [**YouTube**](https://www.youtube.com/@DevOpsinAction?sub_confirmation=1)
* âœï¸ [**Blog**](https://ibraransari.blogspot.com/)
* ğŸ’¼ [**LinkedIn**](https://www.linkedin.com/in/ansariibrar/)
* ğŸ‘¨â€ğŸ’» [**GitHub**](https://github.com/meibraransari?tab=repositories)
* ğŸ’¬ [**Telegram**](https://t.me/DevOpsinActionTelegram)
* ğŸ³ [**Docker Hub**](https://hub.docker.com/u/ibraransaridocker)


### â­ If You Found This Helpful...

***Please star the repo and share it! Thanks a lot!*** ğŸŒŸ




